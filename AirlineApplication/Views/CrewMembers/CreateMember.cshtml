
@{
    ViewBag.Title = "CreateMember";
}

<h2>CreateMember</h2>

<form id="myForm">
    <input type="text" name="name" id="name"/>
    <label for="departmentsDropdown"><b>Departments</b></label>
    <select class="form-control" id="departmentsDropdown" name="departmentsDropdown"></select>
    <input type='button' id="submit" value='Create' />
</form>

@section scripts
{
    <script>
        $(document).ready(function () {

            $.ajax({
                type: "GET",
                url: "/api/profession",
                data: "{}",
                success: function (data) {
                    var s = '<option value="-1">Please Select a Profession</option>';
                    for (var i = 0; i < data.length; i++) {
                        s += '<option value="' + data[i].professionId + '">' + data[i].name + '</option>';
                    }
                    $("#departmentsDropdown").html(s);
                }
            });

            $('#submit').on("click",function () {
                var name = $("#name").val();
                var profId = $("#departmentsDropdown").val();
                $.ajax({
                    type: "POST",
                    url: "/api/crewmembers",
                    data: {
                        'fullName': name,
                        'professionId': profId
                    },
                    cache: false,
                    success: function () {
                        location.href = "http://localhost:57475/CrewMembers/ShowMembers"
                    }
                })
                return false;
            });
        });
    </script>
}